/**
 * iOS-specific CSS adjustments
 * This file contains CSS variables and fixes specifically for iOS devices
 */

@import './variables.css';

/* iOS-specific styles */
@supports (-webkit-touch-callout: none) {
  html, body {
    height: -webkit-fill-available;
  }
}

/* CSS variables for proper viewport height on iOS */
:root {
  --vh: 1vh; /* Will be set dynamically via JavaScript */
  --safe-area-top: env(safe-area-inset-top, 0);
  --safe-area-bottom: env(safe-area-inset-bottom, 0);
  --safe-area-left: env(safe-area-inset-left, 0);
  --safe-area-right: env(safe-area-inset-right, 0);
}

/* Use the iOS-specific vh unit for elements that need 100% height */
.full-height {
  height: 100vh; /* Fallback */
  height: calc(var(--vh, 1vh) * 100);
}

/* Specific fixes for iOS devices */
.ios-device {
  /* Prevent elastic scrolling/bounce effect at boundaries */
  overscroll-behavior: none;
  
  /* Fix for iOS Safari 100vh issue */
  .full-height {
    height: calc(var(--vh, 1vh) * 100);
  }
  
  /* Fix for input elements on iOS */
  input, textarea, select {
    -webkit-appearance: none;
    font-size: 16px !important; /* Prevent zoom on focus */
    border-radius: 6px;
  }
  
  /* Fix for position:fixed elements on iOS */
  .fixed-element, .filterToggleButton {
    position: fixed;
    transform: translateZ(0);
    -webkit-transform: translateZ(0);
  }
  
  /* Fix for buttons on iOS */
  button {
    -webkit-appearance: none;
    cursor: pointer;
    touch-action: manipulation;
  }
  
  /* Disable pull-to-refresh on iOS webview */
  body {
    overscroll-behavior-y: none;
    -webkit-overflow-scrolling: touch;
  }

  /* Fix for swipe actions on mobile cards */
  .mobileCard {
    -webkit-transform: translate3d(0, 0, 0);
    transform: translate3d(0, 0, 0);
  }

  .mobileCardSwipeState {
    -webkit-transform: translate3d(0, 0, 0);
    -webkit-transition: -webkit-transform 0.3s ease;
    transition: transform 0.3s ease;
  }

  .mobileCardSwipeActive .mobileCardSwipeState {
    -webkit-transform: translateX(-140px);
  }

  /* Fix for sticky headers in data tables */
  .tableContainer th {
    position: -webkit-sticky;
  }

  /* Fix for modal scrolling issues */
  .modalContent {
    -webkit-overflow-scrolling: touch;
  }

  /* Fix dropdown menus for filters */
  .modernSelectDropdown {
    -webkit-overflow-scrolling: touch;
    position: absolute;
    left: 0;
    right: 0;
  }

  /* Fix for checkboxes */
  .checkmark, .customCheckbox, .customRadio {
    -webkit-appearance: none;
    -webkit-transform: translateZ(0);
  }
}

/* Special handling for notched iOS devices (iPhone X and newer) */
.ios-notched {
  /* Safe area padding for fixed headers */
  .fixed-header {
    padding-top: var(--safe-area-top);
  }
  
  /* Safe area padding for fixed footers */
  .fixed-footer, .mobileNavbar {
    padding-bottom: var(--safe-area-bottom);
  }
  
  /* Ensure content doesn't get hidden behind the notch */
  .container, .mainContainer, .pageContainer {
    padding-left: max(var(--safe-area-left), 16px);
    padding-right: max(var(--safe-area-right), 16px);
  }
  
  /* Better modal positioning for notched devices */
  .modal, .formModal {
    padding-bottom: var(--safe-area-bottom);
  }
  
  /* Fixed bottom elements should respect the home indicator area */
  .bottom-fixed {
    bottom: var(--safe-area-bottom) !important;
  }
  
  /* Adjust full height to include safe areas */
  .full-height-safe {
    height: calc((var(--vh, 1vh) * 100) - var(--safe-area-top) - var(--safe-area-bottom));
  }

  /* Fix for filter toggle button placement */
  .filterToggleButton {
    top: var(--safe-area-top);
  }

  /* Make sure mobile cards have proper padding to avoid notch */
  .mobileCardView {
    padding-left: max(var(--safe-area-left), 8px);
    padding-right: max(var(--safe-area-right), 8px);
  }
  
  /* Ensure modals don't get cut off by the notch */
  .modalContent {
    margin-top: var(--safe-area-top);
    max-height: calc(100vh - var(--safe-area-top) - var(--safe-area-bottom) - 20px);
  }
}

/* Fix momentum scrolling for iOS */
.mobileCardView, .tableContainer, .modalContent, .optionsContainer, 
.formModal, .dataContainer, .modernSelectDropdown, .toggleGroup {
  -webkit-overflow-scrolling: touch;
} 